# Next.js PWA Skill - Complete Documentation

## ğŸ“¦ Package Contents

This skill package contains everything needed to convert Next.js applications into Progressive Web Apps with Supabase integration.

### File Structure
```
nextjs-pwa-skill/
â”œâ”€â”€ SKILL.md                    # Main skill documentation (18KB)
â”œâ”€â”€ README.md                   # This file - setup and usage guide
â”œâ”€â”€ scripts/                    # Automation tools
â”‚   â”œâ”€â”€ generate-icons.js      # PWA icon generator (3KB)
â”‚   â”œâ”€â”€ generate-vapid.js      # VAPID key generator (3KB)
â”‚   â””â”€â”€ test-push.js          # Push notification tester (4KB)
â””â”€â”€ references/                 # Advanced implementation guides
    â”œâ”€â”€ background-sync.md      # Background sync patterns (15KB)
    â”œâ”€â”€ serwist-config.md      # Advanced Serwist setup (6KB)
    â”œâ”€â”€ supabase-offline.md    # Offline Supabase patterns (13KB)
    â”œâ”€â”€ testing-guide.md       # Comprehensive testing (13KB)
    â””â”€â”€ web-share.md          # Web Share API guide (12KB)
```

## ğŸš€ Quick Start

### 1. Prerequisites
```bash
# Ensure you have:
- Next.js 14+ with App Router
- Node.js 18+
- Supabase project (for push notifications)
- HTTPS enabled (required for service workers)
```

### 2. Install Dependencies
```bash
# Core PWA dependencies
npm install @serwist/next @serwist/cli
npm install -D @serwist/webpack-plugin

# Push notifications
npm install web-push

# Icon generation
npm install sharp

# QR codes (optional)
npm install qrcode

# Testing
npm install -D lighthouse puppeteer @playwright/test
```

### 3. Generate PWA Assets
```bash
# Place your source icon (512x512px minimum) at public/icon-source.png

# Generate all PWA icons
node scripts/generate-icons.js public/icon-source.png

# Generate VAPID keys for push notifications
node scripts/generate-vapid.js
```

### 4. Follow Implementation Steps

1. **Read SKILL.md** for the complete implementation guide
2. **Implement core features** in this order:
   - Web App Manifest
   - Service Worker with Serwist
   - Install prompt
   - Offline support
   - Push notifications (optional)
   - Background sync (optional)

## ğŸ“– Documentation Guide

### Main Documentation (SKILL.md)
- Complete PWA implementation walkthrough
- Code examples for all features
- Supabase integration patterns
- Security best practices

### Reference Documentation

#### serwist-config.md (6KB)
- Custom cache strategies
- Advanced runtime caching
- Precaching strategies
- Cache management
- Performance monitoring

#### supabase-offline.md (13KB)
- Offline-first database sync
- Realtime subscriptions with offline support
- Conflict resolution strategies
- Storage optimization
- Authentication offline support

#### background-sync.md (15KB)
- Queue management with IndexedDB
- Service Worker sync handlers
- Periodic background sync
- Form data synchronization
- Sync status UI components

#### web-share.md (12KB)
- Basic Web Share implementation
- Share Target configuration
- Fallback share options
- File and image sharing
- QR code generation

#### testing-guide.md (13KB)
- Lighthouse PWA auditing
- Service Worker testing with Jest
- E2E testing with Playwright
- Performance testing
- Mobile device testing
- Security testing

## ğŸ’» Implementation Examples

### Basic PWA Setup
```typescript
// app/manifest.ts
import type { MetadataRoute } from 'next'

export default function manifest(): MetadataRoute.Manifest {
  return {
    name: 'Your App Name',
    short_name: 'AppName',
    description: 'Your app description',
    start_url: '/',
    display: 'standalone',
    theme_color: '#000000',
    background_color: '#ffffff',
    icons: [
      // Generated by scripts/generate-icons.js
    ]
  }
}
```

### Service Worker Registration
```typescript
// app/layout.tsx
useEffect(() => {
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
  }
}, [])
```

## ğŸ§ª Testing Your PWA

### Run Lighthouse Audit
```bash
# Install Lighthouse CLI
npm install -g lighthouse

# Run audit
lighthouse https://localhost:3000 --view
```

### Test Push Notifications
```bash
# Test your push setup
node scripts/test-push.js user@example.com
```

## ğŸ“‹ PWA Checklist

Before deploying, ensure:

- [ ] âœ… Lighthouse PWA score > 90
- [ ] âœ… HTTPS enabled
- [ ] âœ… Valid manifest.json
- [ ] âœ… Service worker registered
- [ ] âœ… Offline page works
- [ ] âœ… All icon sizes present
- [ ] âœ… Install prompt appears
- [ ] âœ… App installs on mobile
- [ ] âœ… Push notifications work (if implemented)
- [ ] âœ… Background sync works (if implemented)

## ğŸ› ï¸ Troubleshooting

### Common Issues

1. **Service Worker Not Registering**
   - Check HTTPS is enabled
   - Check console for errors
   - Verify sw.js is in public folder

2. **Install Prompt Not Showing**
   - Validate manifest.json
   - Check Lighthouse PWA audit
   - Ensure HTTPS is enabled

3. **Push Notifications Failing**
   - Verify VAPID keys are correct
   - Check Supabase connection
   - Ensure permissions granted

4. **Offline Not Working**
   - Check service worker is active
   - Verify cache strategies
   - Check network tab in DevTools

## ğŸ“š Additional Resources

### Official Documentation
- [Next.js PWA Guide](https://nextjs.org/docs)
- [Serwist Documentation](https://serwist.pages.dev/)
- [Supabase Docs](https://supabase.com/docs)
- [MDN PWA Guide](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)

### Tools
- [Lighthouse](https://developers.google.com/web/tools/lighthouse)
- [Workbox](https://developers.google.com/web/tools/workbox)
- [PWA Builder](https://www.pwabuilder.com/)

## ğŸ¤ Team Collaboration

### Best Practices for Teams

1. **Standardization**
   - Use this skill as the single source of truth
   - Follow the implementation order in SKILL.md
   - Use provided scripts for consistency

2. **Code Review Checklist**
   - Service worker caching strategies reviewed
   - Offline functionality tested
   - Security headers configured
   - Performance metrics meet targets

3. **Testing Protocol**
   - Run Lighthouse on every PR
   - Test on real devices
   - Verify offline functionality
   - Check cross-browser compatibility

## ğŸ“„ License

This skill is created for internal use by your development team.

## ğŸ†˜ Support

For questions about this skill:
1. Check the main SKILL.md documentation
2. Review relevant reference files
3. Test with provided scripts
4. Consult team lead or architect

---

**Version:** 1.0.0
**Last Updated:** November 2024
**Compatible with:** Next.js 14+, Supabase
