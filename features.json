{
  "project": "yi-connect",
  "created": "2026-01-02",
  "updated": "2026-01-04",
  "feature_areas": {
    "aaa-enhancements": {
      "status": "complete",
      "description": "AAA module enhancements for Pathfinder 2026"
    },
    "admin-tools": {
      "status": "in-progress",
      "description": "National/Super Admin administrative tools"
    }
  },
  "features": [
    {
      "id": "health-card",
      "name": "Health Card Activity Reporting",
      "description": "Activity reporting system where EC Chairs/Vertical Heads log completed activities with participation counts (EC and Non-EC members). Links to verticals for tracking.",
      "priority": 0,
      "status": "deployed-awaiting-user-test",
      "deployed_at": "2026-01-04",
      "deployment_notes": "Code deployed to production. Demo login blocked (yi-demo.com fictional). User must test with Google OAuth (director@jkkn.ac.in).",
      "complexity": "high",
      "files_to_modify": [
        "types/health-card.ts - new types",
        "lib/validations/health-card.ts - Zod schemas",
        "supabase/migrations - health_card_entries table",
        "app/actions/health-card.ts - server actions",
        "components/pathfinder/health-card-form.tsx - entry form",
        "app/(dashboard)/pathfinder/health-card/page.tsx - submission page",
        "components/pathfinder/aaa-dashboard.tsx - integrate stats"
      ],
      "test_steps": [
        "Navigate to Pathfinder > Health Card",
        "Submit an activity report with EC/Non-EC counts",
        "Verify entry saved with correct vertical",
        "Check dashboard shows updated activity count",
        "Verify aggregation by vertical works"
      ],
      "form_fields": [
        "submitter_name",
        "submitter_role (EC Chair/Vertical Head/etc)",
        "email",
        "activity_date",
        "chapter_id",
        "region",
        "activity_name",
        "ec_members_count",
        "non_ec_members_count",
        "vertical_id"
      ]
    },
    {
      "id": "depth-metrics",
      "name": "Depth Metrics",
      "description": "Add target attendance, engagement goals, and impact measures per AAA activity",
      "priority": 1,
      "status": "self-verified",
      "complexity": "medium",
      "files_to_modify": [
        "types/aaa.ts",
        "components/pathfinder/aaa-plan-form.tsx",
        "lib/data/aaa-defaults.ts",
        "supabase/migrations - new columns"
      ],
      "test_steps": [
        "Navigate to Create AAA Plan page",
        "Verify each activity has target attendance field",
        "Verify engagement goals field exists",
        "Verify impact measures textarea is present",
        "Submit form and verify data saves to database",
        "Edit existing plan and verify metrics persist"
      ]
    },
    {
      "id": "progress-tracking",
      "name": "Progress Tracking Dashboard",
      "description": "Dashboard showing planned vs completed activities with % progress toward goals",
      "priority": 2,
      "status": "self-verified",
      "complexity": "high",
      "files_created": [
        "components/pathfinder/progress-dashboard.tsx"
      ],
      "files_modified": [
        "types/aaa.ts - Added progress tracking fields to VerticalAAAStatus and PathfinderDashboard",
        "lib/data/aaa.ts - Added progress calculation from health card data",
        "components/pathfinder/aaa-dashboard.tsx - Integrated tabs for Overview/Progress views"
      ],
      "test_steps": [
        "Navigate to Pathfinder dashboard",
        "Verify progress bars show for each vertical",
        "Verify planned vs actual attendance comparison",
        "Verify % completion is calculated correctly",
        "Test with multiple verticals at different stages"
      ]
    },
    {
      "id": "stretch-goals",
      "name": "Stretch Goals Section",
      "description": "Add optional bonus activities beyond core AAA (4th awareness, 3rd action, etc.)",
      "priority": 3,
      "status": "self-verified",
      "complexity": "medium",
      "files_modified": [
        "types/aaa.ts - Added stretch goal fields to AAAPlan, VerticalAAAStatus, PathfinderDashboard",
        "lib/validations/aaa.ts - Added Zod schemas for stretch goal fields",
        "lib/data/aaa.ts - Added dashboard calculations for stretch goals",
        "components/pathfinder/aaa-plan-form.tsx - Added toggle buttons and form sections"
      ],
      "files_created": [
        "supabase/migrations/20260104000001_aaa_stretch_goals.sql - Database columns for stretch goals"
      ],
      "implementation_notes": "Toggle buttons allow adding optional Awareness 4, Action 3, and Advocacy 2. Each stretch activity includes full depth metrics (target attendance, engagement goal, impact measures). Build verified passing.",
      "test_steps": [
        "Navigate to Create AAA Plan page",
        "Verify 'Add Stretch Goal' button appears",
        "Click to add 4th awareness session",
        "Verify optional field styling (different from required)",
        "Submit and verify stretch goals save correctly",
        "Verify stretch goals show separately in dashboard"
      ]
    },
    {
      "id": "activity-templates",
      "name": "Activity Templates Library",
      "description": "Let chairs browse and pick from a library of proven activities across verticals",
      "priority": 4,
      "status": "self-verified",
      "complexity": "high",
      "files_created": [
        "components/pathfinder/activity-template-picker.tsx - Modal dialog for browsing templates",
        "app/api/activity-templates/route.ts - GET endpoint with filters"
      ],
      "files_modified": [
        "components/pathfinder/aaa-plan-form.tsx - Added template picker integration to all activity slots"
      ],
      "files_existing": [
        "lib/data/activity-templates.ts - Supabase query layer (already existed)",
        "types/activity-templates.ts - Type definitions (already existed)",
        "supabase/migrations/20260102000006_activity_templates.sql - DB table with 17 seed templates"
      ],
      "implementation_notes": "Templates button added to: Awareness 1-3, Action 1-2, Awareness 4 (stretch), Action 3 (stretch). Picker modal supports search, vertical filter, and AAA classification filter. Template selection pre-fills: title, description, audience/target, target attendance, engagement goal, impact measures. Build verified passing.",
      "test_steps": [
        "Navigate to Create AAA Plan page",
        "Click 'Browse Templates' button on any activity",
        "Verify modal shows activities from all verticals",
        "Filter by vertical/category",
        "Select a template and verify it fills the form",
        "Verify template source attribution shown"
      ]
    },
    {
      "id": "user-impersonation",
      "name": "User Impersonation System",
      "feature_area": "admin-tools",
      "description": "Allow National/Super Admins to temporarily assume any user's identity for debugging, QA testing, real-time support, and permission verification. Full action capability with hidden audit logging.",
      "priority": 5,
      "status": "in-progress",
      "complexity": "high",
      "spec_document": "docs/SPEC-user-impersonation.md",
      "phases": [
        {
          "id": "impersonation-mvp",
          "name": "Phase 1: Core Infrastructure (MVP)",
          "status": "deployed-awaiting-test",
          "deployed_at": "2026-01-04",
          "items": [
            "Database schema & migrations (impersonation_sessions, impersonation_action_log)",
            "Basic start/end impersonation server actions",
            "Visual banner component",
            "Simple user selector",
            "Middleware integration for impersonation context"
          ]
        },
        {
          "id": "impersonation-ux",
          "name": "Phase 2: Enhanced UX",
          "status": "not-started",
          "items": [
            "Role-based selection flow (pick role â†’ pick user)",
            "Recent users list with persistence",
            "Configurable timeout settings (15min/30min/1hr/4hr)",
            "Session extension functionality",
            "Role cycling (prev/next user of same role)"
          ]
        },
        {
          "id": "impersonation-audit",
          "name": "Phase 3: Audit & Analytics",
          "status": "not-started",
          "items": [
            "Audit log viewer page (/admin/impersonation-audit)",
            "Action-level logging during impersonation",
            "Analytics dashboard (most impersonated users, frequency, duration)",
            "Export functionality for audit logs"
          ]
        }
      ],
      "files_to_create": [
        "supabase/migrations/[timestamp]_impersonation_system.sql - Database schema",
        "types/impersonation.ts - Type definitions",
        "app/actions/impersonation.ts - Server actions",
        "lib/data/impersonation.ts - Data fetching layer",
        "contexts/impersonation-context.tsx - React context",
        "hooks/use-impersonation.ts - Hook for state/actions",
        "components/admin/impersonation-banner.tsx - Top banner",
        "components/admin/impersonation-selector.tsx - Role-based selector",
        "components/admin/recent-impersonations.tsx - Quick access dropdown",
        "components/admin/impersonation-analytics.tsx - Analytics dashboard",
        "app/(dashboard)/admin/impersonation-audit/page.tsx - Audit log viewer"
      ],
      "files_to_modify": [
        "lib/auth.ts - Add getEffectiveUser() that checks impersonation",
        "middleware.ts - Inject impersonation context from cookie",
        "lib/supabase/server.ts - Pass impersonated user ID for RLS",
        "components/layouts/dashboard-header.tsx - Add banner slot",
        "app/(dashboard)/admin/users/[id]/page.tsx - Add Impersonate button"
      ],
      "test_steps": [
        "Login as Super Admin or National Admin",
        "Navigate to Admin > Users, find a user, click 'Impersonate'",
        "Verify impersonation banner appears at top of screen",
        "Navigate to a page with user-specific data (e.g., Events)",
        "Verify data shown matches impersonated user's permissions",
        "Perform an action (e.g., create an event)",
        "Verify action is attributed to impersonated user in normal view",
        "Verify action is logged in impersonation audit log",
        "Click 'End Impersonation' in banner",
        "Verify return to admin's normal view",
        "Navigate to Admin > Impersonation Audit",
        "Verify session and actions are logged correctly",
        "Test session timeout by waiting for configured duration",
        "Verify auto-end after timeout with proper logging",
        "Test role-based user selection flow",
        "Test quick-switch between users of same role",
        "Test recent users list persistence",
        "Test impersonation analytics dashboard"
      ],
      "security_requirements": [
        "Only hierarchy_level >= 6 can impersonate",
        "Cannot impersonate users with >= own hierarchy level",
        "Cannot impersonate self",
        "All impersonation activity is immutably logged",
        "Impersonation cookie is encrypted and httpOnly",
        "Session validation on every request"
      ],
      "interview_decisions": {
        "primary_goals": ["debugging", "qa_testing", "realtime_support", "permission_verification"],
        "action_scope": "full_action_capability",
        "audit_trail": "user_attribution_with_hidden_admin_log",
        "user_selection": "role_based_quick_access",
        "session_timeout": "configurable_15min_30min_1hr_4hr",
        "visual_indicator": "persistent_top_banner",
        "blocked_actions": "none_full_trust_model",
        "who_can_impersonate": "national_admin_and_super_admin_only",
        "audit_visibility": "all_national_admins",
        "quick_switch": "recent_list_plus_role_cycling"
      }
    }
  ]
}
